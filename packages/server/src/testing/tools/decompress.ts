
import { pino } from 'pino'
import { asSerializable } from '@/common/util.js'
import { decompress, extractSigner } from '@/services/agents/hyperbridge/ops/common.js'
import { SubstrateHandleUnsignedArgs } from '@/services/agents/hyperbridge/types.js'
import { createSubstrateClient } from '@/services/networking/substrate/client.js'
import { Call } from '@/services/networking/substrate/types.js'

const data =
  '0x28b52ffd6094232dbe00cc7601290004021001ee070000000a0000006d9200206269662d736c7078505b631863df1b20afb2715ee1f1381d6dc1dd065d82240e6981010044c97257ab904a22dafa31e75190e3af9331e81c00520a56b81e48ff7e421739003ed72cde02cfd1bc4225d66ef877500c6ff3cf8305245bcb3cf1c5a6b7287aef000000a765f5877f6c4d8f0000008cd55cfc989f12506f3455ebd661eb4f414ad3bf252a62b08c3f990c0105d1ecb59ffd65c2eb03d02f8a7a8ebc1f88375e4c070000700a702f34da7b4514c74d35ff68891d1ee57930ef942cae934a1e84f693fbb78ca5ed3b0a6893259441444f54301ac696b986000188150180a00080ada3953c4da6d891161502fca503678681378e08b4445621c950e536c7bace43802193340582d34b55ca06a13aa371a56b0d4bb40bc859a2e8bc591ccf63a4785b31018d02657175657374300080082de17580f2348b165a947e71bb8a8b7902637aa758fafc41a95624fd29ff1a803d2da3d6040b7fa2f596742042cc79d21a80efb5a30536bd1063c48be9bfec66790895036f6d6d69746d656e7473ffff80606aae2bd7b130bd39ae3b6bee651db709762a75dfa3f976ea21143e1a479e2680de846c90a1ed186bf80b34ea065d7115df2873441b9a64f18ed344e16020fa2f802fe600019ea90b20e9e6d32713c901e6e2fb597e6b38ac62deed827d2b5749dc8091589d386f12b1fd935c1f052185520f6a9881519fba91783a7daa81bac930de8057f95641c9c484134f304b990a96d5d72dea641a94a264bf2af06b8a46503a2d8034fc50959619b0be4566913d043789bd84ac6c605c77718771babe40a36feeba80b806077f09db096af223f47617b882a98013091bfc2cb4d89d7aaf12b952dd0b809202efb6399c366288b6b51bef85bcd42b992bce1760538d5c9d8d5d80a71fb58012bf8688ec9724fb90d76fbd7fb55127176b14375962368c2e14cfd4b3eb5363804591017990d917eecd7c5707b58ab23875b8404362e80e57f01691dfe1cd79f280b6d4818569e2aaa22c9307ab290a0d094eb5d45a5460e2790953257b1679367180a38ceeabe39def932da8598425779bd81ad1d8228db0f05266904ddfbf0a570280d12703e27d4f0cc55be81bb1c9b03df87ebe6b98b7133bc104cae7caa7ed12498007ea961ab044f220c09462e25faf5f70eb17e2f15cdf5ec5518287f48bc840e38059871dbadd1cc0fa34aad36b2d0a73e9aa165caa4e70310233d4836d8f3b74fa8080007a829aaf43749d0ff058e9aa35a4cd7c5297d4ce861713154f6c1ed87e0e4d0880ffff806e4cb6b191f1185933bc665dbf9433a4431b7cb0b8500fdb259fc4cfc8d627d9807b3c9fe7d4e24d307130f84d98b64ad0397a3e7b2be8ab9db9cafc9e7f2f7ce380321f4394fb47b8e6ffedaa3b01f8cb86ee61c2bfdb78a27577ed3b1a8b477c7d80557e71ade9a7dff3e979ddc6995eaac88a696bbecc1e5a17d28d9543d1e5eb1a80962b4ed879f4fd95f4ab585178dc1dd87200bd20df3606725cc3d960fae36dd380b4ce5a7606b78cce6893c2ec0520328aeccaf5f90b33167c7db18ec944bf8a09805d843e1d3e2b35db4198f25b2e514949b2287be425996f3a095c62201b46646d807e6f56c0dca767e2a2a0b681729ddd57eb2832a4a3d5c1b4038fea3cedadd45b80f0c84c093e006740062ae7710f8b4aa519a4b35ce9e3d0794fbf8151bb14c125806e8f401fcfadd54ecfff390e30d4eb9a416b1869aae09b0de58b9837a27224fb80f21fa1c83fb3d6e967527523980189c9f73cca7a5b3187ae4cf3da994df1d34980d5d6dcea296ada17aad84afddf7782b01df07b4f9787829cee3ad6e1e4e31ce1801d6437727a2d4bcf63c386bf55b289615e6e4b792fe1dc141aadafa865f0428a806fbe020bc9920a0f3c044fcd11db6ac007adf4f057a743a68757846bb1047f8b80c51f2fd99052db17b0a294b49a1c0a9e13e8b568e73473e8239b9f9f745134fa80ece65a2309b884a2d951a66c47ce85e97cb094ee94a52a72fd45596fa6038da67d0bd1ace34f24ae56910736ba4cbf306784382d3e7dcc08ba618cc40f364c7680a1f96a3199704ba81888ee42f51a5ec38992a00640280a2b04c343f3de2af2b4805ab06dcac5e1df3e62d87cc28f3f2ab0b444aabd796c8d6bc7e074082a880448804a65997682b2b625da667d77a96b92688c9c272c2cbfb0e13e60273b15d60034800f5fa3950a1eaaa547aa74474a0edf270a6c44aa831cbb158ed0b5622088b5a9801f4028804411bb346db2554f12af5f074d126064b0e9121a53cf49d905011f6480c264f9d56c29b8a0797c9a76f7e84abfe72bc4be04c73eea0f7347c0e56b7a4d80b916cdfc5c07416577aa03c0b158a8d41556ad1ee2651735e6dc3340828652f8804446987f9c14d53ea8bd27a55d5121c88d84268a3792493bce4abed701e18079808a7d7dc0630dc11df7029a11cc32c3b103e980b6c12614383557e89b7d26531180fe40f8e7ecad7c4945ac2e4617fbf6ad7492ea8072faa3556b50b04c4c7755ae800c1843bf26ed1269f59b8f64eeb4c56cf11f6dc1c70881c8d831541d27f8ab8a80ddfed434bc1575a883dbd0264dd325589187b14bdb74c4d10e56513a540b72e480e71c304586bd06b5d50483f0779f1a69a012aeab5a0a826e47a5fe3d822bb815801fccaf4a3c16c5ac4697480303f3935010a04421c065a1e9ed5d0f9bbc9ec53b805d2a0d8a872cf2e26a1a0131b93ed8bf589af24285e69129af63cd785e08e6a925038085c880922b17910559dc8a1f44a3a82d6eefe830a550d3f6587870d6baae674ac267ea80a52234a8dcc1c845ef4abe04ba9e82ddd9d20263519f5cd3a0c66c54280d42108033872eaa464efa4d952e000a8f209030167ad5bbbc9c31ee2ca68a37dee998958018db7381320b8f1d0e5271ee41eb3786663f440cb50877db5e2460c10944708480accda7ac337a90c1d9ddd2bd45c94fac7c1f01728616831162ab5122b4434e1080ca9eef2b7ed25dde9e73f81f99a12f308cc1031e66b3d67a219608785879846301013f1d5098940b01b09300bf923ddbc9caa0c632fb393ff0f5e09123e63f30ea96d46d1bce1253a4b769b0b62a1f0ee25a23f13af4e6a50054c30a6b2a46ce763005016d6f646c1027007159ef446edbb68154993e8f2368c0a7f4fd512c15107adfa93a5faea01f450480455aef13bbd95b2178863b9ce15a4225c2df37bc41402e11fef9bcab904b0f8d8015cfa73bf9ab4ade09e5c9dea3bd795c8f3a3255e8fe188c2ea303db5bc790c4808f896510fae3baa566145d519ebaf04263f78173370f361efabc5bddea6d8a708003a47ddeb5c3eb447160ac8154fc0bdfbb0e4bb6438ff19411951dc0c6535ba48076929de5c6dc35ea5129410d0240fa8955230d446181303afa76284dad78e2f1800d517cbf8207f78c9c6b514e4d6a11db0ac24786a4820962bb6c0877958470688030aaba417ec533c86677158a462b0b8651144ed1f911ad490658947d63ce65ef8092afdffa2f4a37a55dedbc5db5f647710e27d56cfab4d2385d4f9f90367f1424805921acf6b9ccee8bf4a784bb262a7bcee465f4e78267c7e6e1b2fd15a6eac0aa80d88bb1da7a465504a82e43ef8cbdaefab7ec2c4f07fced5942a6948adecc3b9a80d7cbf5e3a5abb589137f96cd8f9bf3f75918e32bf61a3055572bb92d24be7c6980a0d0693ac0ea78e491d6cdba494b52df5e3163e216ca20aaa0dc83d5d1340973801c6592b61f9126057de3a7f9c3ea3be33d39b28a2af8712300757d5279b958b18091ba481ee39ce0e8c12c4eb6c581240f3a432e6ea5196157e31b3725f204d8cc807261716fdec2ff0fc71feec32f441c32e72f5ec53bf9544aeb9e05d561542df54dd690d2b25be273c1d58f9c806178666c0dbe980aacfdbf379e3b25e6c2da09f8809c5ec0acd3ffcc8ec6363611e8faedbbb0c116ae4a2da147619d6e13660a49338010dd18d943c9d4153c17b5d454ce1012b0c5af6835922b87d6a2336bb74f278880ccf13aa621c2c2366775bcf7de94fd11c2bc84a2f237b0455151c655f21da5bc8005084441c32900b056987015d9fe7e8924afba60f6621ca0b286101994b32aad8020512944daee19a6679724ca45aca1e05d76a2c66c0ff61af51cf856745c15dd804df81c90223bd4aaf8a0091173eb246978a99195cde4191fd669a5ad29fc4082807798a3ec2f408e7da8ead5fc9fa97696d8346a84258558062bc09466575eb6868047e56501d8f652b617e2265f7d8b24ae1bc709307a7d62794c82ca4fac45a9ea80e4c9c26e238edc6289e684d6b0621dc831336064367af01fb568d0c5c491dd3080263009a0367486d29563257d32ebb56abe43b6a952d693fe7b259f5988bf50528014139ad7f68cdf70481fccd56d2686d25d59db480cd3e30ec3405c357c855fdb8061402313822e6716ed4ce10a61c750d764f106507eb7273bee54b9698ae961358088a27df7f286a9e3716e58b7e5846898b4e5cfc8e4d42c9548d0a4b4fefe5eff80cb193488f451638a6d2f8156ba587245a4f75d1690bcc6517255a881b9ca26e58041b6d3a8625f0bf65098d3ca87b54077e609726a016cdc1b5eb20d20e1a5eaaf2d0480d0ab803fd1b313de148728adcfd83378ad0bbb6018a29d4e385f47e2cf821aa613b37e80a12196c57cf98048f2c36762819870e670d2b38f2e992e61f78bbe35402d5a7480accc1eb7f9c160eee8dfbc654568dcf622b06858b41f7864124eb337e14061698099e6ad971f07cb4c5918a8d72a3950dd275d3a0b232e58fd9689c3dd2c87fee080d97477ae422b58686b5eb4e2b44bcf4d2b6e3bea49219835bfacea69459a33d580ba5f010630a1d488631107622059b8d5a918658bae7fecbb322147cf6444ff2580c8ed61a536fa279983a229aa30b5c9cc67370888b5f6dbc56691e45cd6bf0968808ffc58ec5eac9b94327c9c1ef77b9fbde711b638570daabd79d9173c7f5c120d01013f1d13d14f88733459db3053428640f2dfb404103c027c86460e0f8b826abe1a8fbe3a750cf10eb60497278f3d7709e71c6c494f93ac87cfbb7db839231f4acc80ae1c0db8c361f9e9291e5446401fccd488c919787cb828d784aac6a807bfb13b80b95f0f1c44980e4088bf9b4d0284a62ca1022de5b3dd5840b97ac58d2f028ebc80f86cbbb03ae9dd2af1b16ca7cee0c5f6d1b2f6951b17bc385713119b23468c6d80524c2e706b84cff51b691fb6bcd3a66e8c12e5e79fb25b9678855be123e8b201803eda4efb32261c232a5a7f997a2d0f49e857e2673a32f590722682057c267f8f804829e6ae4de945bb25676bd09759bb1533a2158e697a6c267c18beeb8e7ae8c780e824a5fdf699bec4de25f61b76e200f87937523ff25effea850ccfcb1415030080d020eb0d283d1e0d68a521d2faf8473ba062afb83160f81972b45f4ed4bda2aa80644c98226cfc58144c1af9f79dde96062032cb78232204eb524b52eaf0a506ee80232470841a8912afe4ee2df859a774921de949d430574f18efbf66de95c0521f80ad77a2d0e579d36e6c78f919bac71a9feffa779ca5f3b3f5bbb1189a36d345b6803eecb4535769cd0579705732225666db3a1da66fa52f80c8c8ebb8d3519a191180e604ba6754fdafe8f5e7bb6b85394b10a991b0de58a38c9d967b794570d1fe8a801491dc8ec1fcf8831a69789c4801d29027e3ecd963837b4bf1b7f6f40edb817d80bd4a0660eb117e86b17b8990c669f583696ac2fd530ff6702ee7eccb9505f39aa10280c089807047c01a83780166282014f9e9d93de4c481d34a88eb7586b3d5896c00f1d3578075a6069c0d2b952b970892cf9702d78f40b6552328ea190d41ab4b5b04b29d9780174d8f073c46936234bae69b741764f1896f522108729725b7d2918a09b5bde780b4b8538dfb3833618b998bde763d4436b11fc986cd6adb68cc99d27d168e9f0b807dea45ac67cb78247903bd2d138d5710d9e2eede001a409999fe336d1fe68d3e1501800808802e7ffef964ea86c090a3b5b4118ca41734ba3631773a7fadcdc8d47f459a3b25802defcd522f830ad4749204f4cfe7ab1fed4558330b9ba89d602abc8040fc2feb15018080018056c413cc8578ba5645ea9abf915fdc83e7eba7243c21233b383f02841d539eb980f3ef45de7cb576802d82e8cdfa7295e86205b71e6f6398aee682eff80f6c7235fc3f1b7cb706996f52a42002b04f022e3e65bd16409a95ee7b652fdec09c1e2a36e19baf06a2d940edf45b9e784eceaf9c4961d5138f55c4dcb915933577682b804fdeb0e12375541ae835eedba6ace973c345c26dcf97a1d106f5248bd170b98480112100815788a7d747b898bd994c48389387557c2477c7240c2fe5e64c7a448080d045452c316b7c5d6ce4576916d2e435243096568ce10f7507b01921e631122c801e2e3cd49f7653d7c1effc34d0be09f94db6b65e3dfdd8260c61d8f4d21a4f8f80c5ca0e0411b9795af1c8f702a8848e1e923aae374475101c2579f8fc2e73e81a809317bf551a2a28efa9f17ecea9ac511dd965baa06b64bf3a5c33a746fc2f212280f277ef2a7aadf3ccd60bc7d766dad9e9654be28b867f744b78a2954d24c83c7380fb1773c60b80a646f45aaef99bc2b9eac69d00b624ff247232481f2a183a79a880658d1637ba8dff2bf4d3bbfc0c198815584664cfd7c4c5c1fc5264631b83014e80d4017e65e96aa9ef363f856ec3763c7100aa1b800822d37d951514fd5583ca5d808b423632a1945b04382ce4624b89fc4f8b205123ca47b78f3065b616be40de53804c8701d0d16706970451405ffcede6456f4836a3ad42a45b088b6fcbf195b82b80974facbae08442870c9bff9fe3285ff842678d993a986a033ab7a281601c9f1d8019206cf7e09162964263d45ba45a333b354b5035ebabebc0f72d8fea98753bee8043c69c6a35f50370c4798b8020fb77d8ff33729f1931d42b46af176de84e6d724d1053630c9e2c67239025b0796beac8ac24aaed497b6e81e2f74d9c403558bb8b80ee1b296a3abd4c5a76a274d26ebeeb57e829d166cf54722eaca1a67bb48b1a1c80cf38dcc6868cdd50bff4ad463190e99ddba6c523740253f3e8d95bf5e44d56df80d57987ff5c1036a540f2fdafde257bc2eadb8d26a4d6abd37615493370f3a7fc80e9771184e0414ce7fb2c7ffeebd81361c445cb8d502543915ec7a92c208090b080af3936a0445765a8cbcaf5475cf3eeaa1acfc6f818d25391496bf8efa731fcf88027d346e981f9d8d82f98cc7f2daf6d654c27af24fb9617a45780d2c0e5d8f9968046c573750986fb04bbd96a0587bbeeab53ed58ffe155625ddcc14509ca623e78801a369221fb2726ebf47ecb67beb4218f5f741025227d3c52442d11475c878b8880256b87387cc6d46f46d0e82246eb116a1dae5d72a2434901c3a1ac817ebbecc580ed42278cb808d367f35781f53e3b4663bbb176a678031fa60a0e24be2e76ef1580cb4651b7d03bc1e719c5edc15617ae7601e3a748274e04f148a5bae9f7b811938058210aec7d5e3ec369e90c916f6e985d0e01b16cbcee38dbaec4c28286a58ecf80a386f930d3c1737b9dbd6b2191f15ba734812fcd28cd696d1d1a23d64f6f3e238047c60950bf4378648960ec99825ae0ddbabcb90fcff4f4ecedec62e48f3bd51f8028c8df174473dda2b51a77a6ac1331be9e3e76081a42deafbf513e6562b9b2792d048047368009b42b1cb3a498d9176abb504519178ec77be6744839311877380b8d8fa5c38180772d047d97a6ebfb8b9bd6be87f71cd75ead539d9767ae9a3792deb3a9bf064480e7ffd3531b9ec1b3511ee45d7e9cd16dd3276af2cc13b195d971ccefde690f09806559ae22f781aeda021776215c4de67b57d019dc9167e8e44406c1a8bbef267080fc5162043052f6aefab73780f185dd82cbe0410b3af2507ae9f7c73a0d465d4e807e8e9e46b57013d6d6e7708895f38c3f2e1d8a8111a4ba60b02600eb8d7bc6d4803be24945ffcff722a7f5b58b0932ae79219025c36e426a8755132d3008f6703380cfc6b1ad82e5ec9e10ae5205609ccbadc73ab2ef46f02b2cb18845d73768dd1101013f1d89de441fff65be74fb8448609ae50090347cd7948afc911b18963986cf8d32c9c8665fe80662c4496c2312a8d4ce86941d74e19f7a996364ae4296d383ba05881391010180d4b242520b6777ed9c658ea10e1018495797f8e92957ce7b568aea714ab18f640101fc7b197b65b8292718a7bb8936a5a4e085cc2ff94c805c0f8f39c6cb69ecb448363eb48102e7fd7c65adb8cc6b1906b0fbd59e4f0da0e330fe3704d30b3a6d82202050c3240549c1031df6559142506d7a76a343a44a7dc244879f428890b864a0b227875d90920f805309c2a311084a9fc170e8bcac6811f0b13e666a0c557c5f881437eff33e4695b773f374da94c16228618ff0c2'
const size = 9364

const logger = pino()
const client = await createSubstrateClient(logger, 'urn:ocn:polkadot:3367', 'wss://nexus.ibp.network')

logger.info('Connected')
const dec = await decompress(data, size)
const ctx = await client.ctx()
const call = asSerializable(ctx.decodeCall(dec)) as Call
const { messages } = call.args as SubstrateHandleUnsignedArgs
console.log(messages.filter((msg) => msg.type === 'Request'))

const { requests, signer } = messages.filter((msg) => msg.type === 'Request')[0].value
const signerAddress = extractSigner(signer)
console.log(signerAddress, requests)
process.exit()
